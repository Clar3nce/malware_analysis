[Home](index.md)


## AlinaPOS

### Skip Ahead
  * [Communication](#communication)
  * [Configuration](#configuration)
  * [Encryption](#encryption)
  * [Obfuscation](#obfuscation)
  * [Main Functionality](#main-functionality)
  * [Yara Rules](#yara-rules)
  * [Samples and Hashes](#samples-and-hashes)




### Communication
  So at first glance AlinaPos deosnt do anything fancy for its network communications, no encryption, no HTTPS just plain old Wininet requests with some pretty simple paramaters for the communication.
  So lets have a look at the data that it sends with a request to the Web Panel.
  Essentially for the first request it populates a structure that is defined within the header file that handles the building and interpreting of requests sent and the responses received from the Web Panel.

  ```cpp
  struct AuthHdr
  {
    WORD          version;
    char          sVersion[16];  // The internel version number of the malware.
    char          hwid[8];       // The machine specific HardwareID.
    unsigned char nonce[2];
    char          action[8];     // The action to perform. This determines what kind of data to send and what to expect in response.
    char          pcName[32];    // The Name of the currently infected machine.
    DWORD         size;
    unsigned char sig[4];        // This seems to always be set to 0xab12de34 from what i can tell.
    unsigned char data[0];
  };
```
During the building of this first request it also populates a series of values in a class that contains most of collected system informatin that will be outlined in the next section.


### Configuration
  
```cpp 
class base
{
  public:
    //Functions for getting system paths that are going to later be used by the malware as well as the basic file and process IO opperations that the malware is cappable of performing

  private:
    DWORD serial;
    WORD version;
    std::string sversion, hwid, pcname, adpath,curpath,inspath, exename. insdir;
    //alot of these variables are pretty self explanitory but just to add an extra bit of clarity they are used as follows.
    //insdir   = the installation directory of the malware.
    //exename  = the name of the exe.
    //inspath  = the full path the malware is installed to.
    //curpath  = the full path to the malware before installation
    //adpath   = the path to the %AppData% folder.
    //pcname   = the name of the currently infected pc.
    //hwid     = the hwid of the currently infected pc.
    //sversion = a version string created from values in the UserAgent.
};
```



### Encryption


### Obfuscation


### Main Functionality



### Yara Rules



### Samples and Hashes
  this is a test to see if inter page linking works 
